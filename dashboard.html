<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Classroom - HCMUTE</title>
    <!-- Favicon -->
    <link rel="icon" href="logo_hcmute.png">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="css/all.min.css">
    <!-- Chart.js for Statistics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="logo_hcmute.png" alt="HCMUTE Logo" class="sidebar-logo">
                <div class="sidebar-brand">
                    <span class="brand-text">HCMUTE</span>
                    <span class="brand-sub">Smart Classroom</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" id="nav-dashboard">
                    <i class="fa-solid fa-house"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" id="nav-rooms">
                    <i class="fa-solid fa-door-open"></i>
                    <span>Phòng học</span>
                </a>
                <a href="#" class="nav-item" id="nav-statistics">
                    <i class="fa-solid fa-chart-line"></i>
                    <span>Thống kê</span>
                </a>
                <a href="#" class="nav-item" id="nav-settings">
                    <i class="fa-solid fa-gear"></i>
                    <span>Cài đặt</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="school-info">
                    <i class="fa-solid fa-building-columns"></i>
                    <span>ĐH Công nghệ Kỹ thuật TP.HCM</span>
                </div>
                <button id="logout-btn" class="nav-item logout">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span>Đăng xuất</span>
                </button>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- HEADER -->
            <header class="main-header">
                <div class="header-left">
                    <h1 class="page-title" id="page-title">Dashboard</h1>
                    <p class="page-subtitle">Trường Đại học Công nghệ Kỹ thuật TP. Hồ Chí Minh</p>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <i class="fa-solid fa-search"></i>
                        <input type="text" placeholder="Tìm kiếm...">
                    </div>
                    <div class="status-badge" id="connection-status">
                        <div class="status-dot"></div>
                        <span>Đã kết nối</span>
                    </div>
                    <div class="current-room-badge">
                        <i class="fa-solid fa-user"></i>
                        <span id="current-room-display">...</span>
                    </div>
                </div>
            </header>

            <!-- ==================== VIEW 1: ADMIN DASHBOARD ==================== -->
            <div id="admin-dashboard-view" style="display: none;">
                <!-- Overview Stats Cards -->
                <section class="overview-stats">
                    <div class="overview-card">
                        <div class="overview-icon rooms">
                            <i class="fa-solid fa-door-open"></i>
                        </div>
                        <div class="overview-info">
                            <span class="overview-value" id="total-rooms">0</span>
                            <span class="overview-label">Tổng Phòng</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon active">
                            <i class="fa-solid fa-users"></i>
                        </div>
                        <div class="overview-info">
                            <span class="overview-value" id="active-rooms">0</span>
                            <span class="overview-label">Đang Sử Dụng</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon temp">
                            <i class="fa-solid fa-temperature-half"></i>
                        </div>
                        <div class="overview-info">
                            <span class="overview-value" id="avg-temp">--</span>
                            <span class="overview-label">Nhiệt Độ TB (°C)</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon humidity">
                            <i class="fa-solid fa-droplet"></i>
                        </div>
                        <div class="overview-info">
                            <span class="overview-value" id="avg-humidity">--</span>
                            <span class="overview-label">Độ Ẩm TB (%)</span>
                        </div>
                    </div>
                </section>

                <!-- Quick Room Status -->
                <section class="quick-status">
                    <h3 class="section-title">Trạng Thái Phòng Học</h3>
                    <div class="room-status-grid" id="room-status-grid">
                        <p style="color: #7F8C8D;">Đang tải...</p>
                    </div>
                </section>
            </div>

            <!-- ==================== VIEW 2: ROOMS LIST ==================== -->
            <div id="rooms-view" style="display: none;">
                <h3 class="section-title">Danh Sách Phòng Học</h3>
                <div class="room-grid" id="room-list">
                    <div class="room-card-skeleton">
                        <p>Đang tải...</p>
                    </div>
                </div>
            </div>

            <!-- ==================== VIEW 3: ROOM CONTROL ==================== -->
            <div id="room-control-view" style="display: none;">
                <!-- Back Button -->
                <button id="btn-back-rooms" class="btn-back">
                    <i class="fa-solid fa-arrow-left"></i> Quay lại danh sách
                </button>

                <!-- STATS CARDS -->
                <section class="stats-section">
                    <div class="stat-card">
                        <div class="stat-icon temp">
                            <i class="fa-solid fa-temperature-half"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-label">Nhiệt Độ</span>
                            <div class="stat-value-wrapper">
                                <span class="stat-value" id="temp-value">--</span>
                                <span class="stat-unit">°C</span>
                            </div>
                        </div>
                        <div class="stat-progress temp">
                            <svg viewBox="0 0 36 36">
                                <path class="progress-bg"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path class="progress-bar" id="temp-progress" stroke-dasharray="0, 100"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            </svg>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon humidity">
                            <i class="fa-solid fa-droplet"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-label">Độ Ẩm</span>
                            <div class="stat-value-wrapper">
                                <span class="stat-value" id="humidity-value">--</span>
                                <span class="stat-unit">%</span>
                            </div>
                        </div>
                        <div class="stat-progress humidity">
                            <svg viewBox="0 0 36 36">
                                <path class="progress-bg"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path class="progress-bar" id="humidity-progress" stroke-dasharray="0, 100"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            </svg>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon light">
                            <i class="fa-solid fa-sun"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-label">Ánh Sáng</span>
                            <div class="stat-value-wrapper">
                                <span class="stat-value" id="light-val-value">--</span>
                                <span class="stat-unit">Lux</span>
                            </div>
                        </div>
                        <div class="stat-progress light">
                            <svg viewBox="0 0 36 36">
                                <path class="progress-bg"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path class="progress-bar" id="light-progress" stroke-dasharray="0, 100"
                                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            </svg>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon presence">
                            <i class="fa-solid fa-person-walking"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-label">Đang Sử Dụng</span>
                            <div class="stat-value-wrapper">
                                <span class="stat-value presence-text" id="presence-value">--</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- CONTROLS SECTION -->
                <section class="controls-section">
                    <!-- Auto Mode & Master Controls -->
                    <div class="master-control-bar">
                        <div class="auto-mode-toggle">
                            <span>Chế độ tự động</span>
                            <label class="switch">
                                <input type="checkbox" id="auto-mode-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="master-buttons">
                            <button class="btn-master on" id="master-on">
                                <i class="fa-solid fa-power-off"></i> Bật Tất Cả
                            </button>
                            <button class="btn-master off" id="master-off">
                                <i class="fa-solid fa-power-off"></i> Tắt Tất Cả
                            </button>
                        </div>
                    </div>

                    <!-- DEVICE CARDS GRID -->
                    <div class="devices-grid">
                        <!-- LIGHTS -->
                        <div class="device-group">
                            <h3 class="group-title"><i class="fa-solid fa-lightbulb"></i> Hệ Thống Đèn</h3>
                            <div class="device-cards">
                                <!-- Light 1 -->
                                <div class="device-card" id="card-light-1">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-lightbulb" id="light-icon-1"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Đèn 1</span>
                                            <span class="device-status" id="light-status-1">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="light-toggle-1">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Light 2 -->
                                <div class="device-card" id="card-light-2">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-lightbulb" id="light-icon-2"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Đèn 2</span>
                                            <span class="device-status" id="light-status-2">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="light-toggle-2">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Light 3 -->
                                <div class="device-card" id="card-light-3">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-lightbulb" id="light-icon-3"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Đèn 3</span>
                                            <span class="device-status" id="light-status-3">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="light-toggle-3">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- FANS -->
                        <div class="device-group">
                            <h3 class="group-title"><i class="fa-solid fa-fan"></i> Hệ Thống Quạt</h3>
                            <div class="device-cards">
                                <!-- Fan 1 -->
                                <div class="device-card" id="card-fan-1">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-fan" id="fan-icon-1"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Quạt 1</span>
                                            <span class="device-status" id="fan-status-1">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="fan-toggle-1">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="fan-controls">
                                        <div class="speed-label">
                                            <span>Tốc độ gió</span>
                                            <span id="fan-speed-value-1">50%</span>
                                        </div>
                                        <input type="range" min="1" max="100" value="50" class="range-slider"
                                            id="fan-speed-1" data-id="1">
                                    </div>
                                </div>

                                <!-- Fan 2 -->
                                <div class="device-card" id="card-fan-2">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-fan" id="fan-icon-2"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Quạt 2</span>
                                            <span class="device-status" id="fan-status-2">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="fan-toggle-2">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="fan-controls">
                                        <div class="speed-label">
                                            <span>Tốc độ gió</span>
                                            <span id="fan-speed-value-2">50%</span>
                                        </div>
                                        <input type="range" min="1" max="100" value="50" class="range-slider"
                                            id="fan-speed-2" data-id="2">
                                    </div>
                                </div>

                                <!-- Fan 3 -->
                                <div class="device-card" id="card-fan-3">
                                    <div class="device-header">
                                        <div class="device-icon">
                                            <i class="fa-solid fa-fan" id="fan-icon-3"></i>
                                        </div>
                                        <div class="device-info">
                                            <span class="device-name">Quạt 3</span>
                                            <span class="device-status" id="fan-status-3">Đang Tắt</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="fan-toggle-3">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="fan-controls">
                                        <div class="speed-label">
                                            <span>Tốc độ gió</span>
                                            <span id="fan-speed-value-3">50%</span>
                                        </div>
                                        <input type="range" min="1" max="100" value="50" class="range-slider"
                                            id="fan-speed-3" data-id="3">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- ==================== VIEW 4: STATISTICS ==================== -->
            <div id="statistics-view" style="display: none;">
                <div class="stats-charts-grid">
                    <!-- Temperature Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fa-solid fa-temperature-half"></i> Nhiệt Độ Theo Phòng</h3>
                        <div class="chart-container">
                            <canvas id="tempChart"></canvas>
                        </div>
                    </div>

                    <!-- Humidity Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fa-solid fa-droplet"></i> Độ Ẩm Theo Phòng</h3>
                        <div class="chart-container">
                            <canvas id="humidityChart"></canvas>
                        </div>
                    </div>

                    <!-- Light Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fa-solid fa-sun"></i> Ánh Sáng Theo Phòng (Lux)</h3>
                        <div class="chart-container">
                            <canvas id="lightChart"></canvas>
                        </div>
                    </div>

                    <!-- Usage Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title"><i class="fa-solid fa-clock"></i> Tình Trạng Sử Dụng Phòng</h3>
                        <div class="chart-container">
                            <canvas id="usageChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Toast Notification Container -->
            <div id="toast-container"></div>
        </main>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <script src="firebase-config.js"></script>
    <script src="dashboard.js"></script>
</body>

</html>